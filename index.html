<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>WiFi Check</title>
    <style>
        body { font-family: Arial; padding: 20px; text-align: center; }
        #wifi-info { display: none; margin-top: 30px; }
        button { padding: 12px 20px; font-size: 18px; cursor: pointer; }
        canvas { margin-top: 20px; }
    </style>

    <!-- Self-hosted QRious -->
    <script src="js/qrious.min.js"></script>
</head>
<body>

<h2>Connection Check</h2>
<p id="status">Checking connection...</p>

<div id="wifi-info">
    <h3>Not connected to the correct network</h3>
    <p>Please connect to the Wi‑Fi below:</p>

    <p><strong>SSID:</strong> MyNetwork</p>
    <p><strong>Password:</strong> mypassword</p>

    <canvas id="qr"></canvas>

    <button onclick="openWifiSettings()">Open Wi‑Fi Settings</button>
</div>

<script>
const CHECK_URL = "http://192.168.1.10/ping";  // <-- change this to your server
const WIFI_SSID = "MyNetwork";                 // <-- your Wi‑Fi name
const WIFI_PASS = "mypassword";                // <-- your Wi‑Fi password
const WIFI_ENCRYPTION = "WPA";                 // WPA, WEP, or nopass

// Try pinging your server
async function checkConnection() {
    try {
        const response = await fetch(CHECK_URL, {
            method: "GET",
            cache: "no-cache",
        });

        if (response.ok) {
            document.getElementById("status").innerText =
                "Connected to the correct network ✔";
            return;
        }
    } catch (e) {
        // Server unreachable → show Wi-Fi credentials
        showWifiInfo();
    }
}

// Show Wi-Fi QR code + credentials
function showWifiInfo() {
    document.getElementById("status").innerText =
        "Not connected to the required network ✖";
        
    document.getElementById("wifi-info").style.display = "block";

    const wifiQR = `WIFI:T:${WIFI_ENCRYPTION};S:${WIFI_SSID};P:${WIFI_PASS};;`;

    new QRious({
        element: document.getElementById("qr"),
        value: wifiQR,
        size: 250
    });
}

// Opens Android Wi-Fi settings
function openWifiSettings() {
    try {
        window.location.href =
            "intent:#Intent;action=android.settings.WIFI_SETTINGS;end;";
    } catch (e) {
        alert("Cannot open Wi‑Fi settings on this device.");
    }
}

checkConnection();
</script>

</body>
</html>
